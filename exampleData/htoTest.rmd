```{r}

source('../seurat/cellHashingFunctions.R')

#Relatively good input.  Several outlier cells with extremely high counts.
barcodeFile <- 'cellHashing/247-1-hashTagCounts.txt'

#Extremely high doublets
#barcodeFile <- 'cellHashing/267-1-citeSeqCounts.txt'

#barcodeFile <- 'cellHashing/267-2-citeSeqCounts.txt'

#barcodeFile <- 'cellHashing/253-1-citeSeqCounts.txt'

#barcodeFile <- 'cellHashing/248-7-citeSeqCounts.txt'
finalCallFile <- 'finalCalls.txt'

```

# Basic QC and Filtering on input:

```{r}

barcodeData <- processCiteSeqCount(barcodeFile)

generateQcPlots(barcodeData)


```


# Using Seurat:

```{r}


sc <- generateCellHashCallsSeurat(barcodeData)


```

# Using MULTI-seq Classifier:

```{r}


mc <- generateCellHashCallsMultiSeq(barcodeData, showTSNE = F)


```



```{r}

dt <- processEnsemblHtoCalls(mc, sc, barcodeData, outFile = finalCallFile)


```